<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<title>Modelling Disease Spread</title>

	<link rel="stylesheet" href="dist/reset.css">
	<link rel="stylesheet" href="dist/reveal.css">
	<link rel="stylesheet" href="dist/theme/mpi.css" id="theme">

	<!-- Theme used for syntax highlighted code -->
	<!-- Theme used for syntax highlighting of code -->
	<link rel="stylesheet" href="lib/css/zenburn.css">

	<!-- Printing and PDF exports -->
	<script>
		var link = document.createElement( 'link' );
		link.rel = 'stylesheet';
		link.type = 'text/css';
		link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
		document.getElementsByTagName( 'head' )[0].appendChild( link );
	</script>

</head>

<body>
<div class="reveal">
<div class="slides">



<!-- ############################################################################### -->
<section style="min-height:1080px">
    <div style="padding-top:100px">
        <h2>Modelling Disease Spread</h2>
    </div>

    <div style="padding-top:120px">
        <b>Johannes Zierenberg</b><br>
        <!--Neural Systems Theory<br>-->
        Max Planck Institute for Dynamics and Self-Organization, GÃ¶ttingen, Germany<br>
        <br><br><br>
        as part of<br>
        <b>Current topics in theoretical physics</b>
    </div>

    <div style="position:absolute; bottom:0; width:100%">
      <img src="logos/Max-Planck-Gesellschaft.svg" height=300 style="border:0; box-shadow:none; background:none;margin-right:50px" align=right >
      <img src="logos/JHS_Logo_sRGB_violett.jpg"   height=300 style="border:0; box-shadow:none; background:none;margin-right:50px" align=left >
    </div>
</section>

<!-- ############################################################################### -->
<section style="min-height:1080px">
    <h3>Outline</h3>
    <div style="position:absolute; top:15%; left:15%; width:70%; height:15%; text-align:left; border:3px; border-style:solid; border-color:#708090; padding: 0.2em;">
        <h3 style="border:0; box-shadow:none; position:absolute; top:30%; left:0%; width:100%; text-align:center">General introduction</h3>
    </div>

    <div style="position:absolute; top:35%; left:15%; width:70%; height:15%;  text-align:left; border:3px; border-style:solid; border-color:#708090; padding: 0.2em;">
        <h3 style="border:0; box-shadow:none; position:absolute; top:30%; left:0%; width:100%; text-align:center">Mathematical basics</h3>
    </div>

    <div style="position:absolute; top:55%; left:15%; width:70%; height:15%;  text-align:left; border:3px; border-style:solid; border-color:#708090; padding: 0.2em;">
        <h3 style="border:0; box-shadow:none; position:absolute; top:30%; left:0%; width:100%; text-align:center">Disease spread on networks</h3>
    </div>

    <div style="position:absolute; top:75%; left:15%; width:70%; height:15%;  text-align:left; border:3px; border-style:solid; border-color:#708090; padding: 0.2em;">
        <h3 style="border:0; box-shadow:none; position:absolute; top:30%; left:0%; width:100%; text-align:center">Non-Markovian disease spread</h3>
    </div>
</section>

<!-- ############################################################################### -->
<!-- ######################  GENERAL INTRODUCTION ################################## -->
<!-- ############################################################################### -->

<section style="min-height:1080px">
    <h3>General introduction</h3>
    <div style="position:absolute; top:15%; left:15%; width:70%; height:15%; text-align:left; border:0px; box-shadow:none; background:none;" data-markdown>
        #### What we will talk about
        * Models need to simplify reality
        * Simplification has to be suitable for scientific problem
    </div>
    <div style="position:absolute; top:50%; left:15%; width:70%; text-align:left "class="fragment fade-in" data-fragment-index="2"  data-markdown>
        #### References
        * Kiss, Miller, and Simon, "Mathematics of Epidemics on Networks: From Exact to Approximate Models", (Springer International Publishing, Cham, 2017).
        * Pastor-Satorras, Castellano, Van Mieghem, and Vespignani, Rev. Mod. Phys. (2015).
        * additional sources of examples are referened at bottom of slides
    </div>
</section>

<section>
    <h3>Why should we model disease spread?</h3>
    <div style="position:absolute; top:12%; left: 1%; width:55%; text-align:left" class="fragment fade-in" data-fragment-index="1" data-markdown>
      <script type="text/template">
        * Understand general mechanisms: <!-- .element: class="fragment fade-in" data-fragment-index="1" -->
            * Development of spread<!-- .element: class="fragment fade-in" data-fragment-index="1" -->
            * Identify most probably paths of spread<!-- .element: class="fragment fade-in" data-fragment-index="2" -->
            * how to vaccinate <!-- .element: class="fragment fade-in" data-fragment-index="3" -->
            * effect of quarantine <!-- .element: class="fragment fade-in" data-fragment-index="4" -->
      </script>
    </div>

    <div style="position:absolute; top:50%; left: 1%; width:55%; text-align:left" class="fragment fade-in" data-fragment-index="2" data-markdown>
      <script type="text/template">
        * Describe ongoing outbreak: <!-- .element: class="fragment fade-in" data-fragment-index="5" -->
            * infer basic parameters of spread <!-- .element: class="fragment fade-in" data-fragment-index="5" -->
            * Estimate effect of interventions <!-- .element: class="fragment fade-in" data-fragment-index="6" -->
      </script>
    </div>

    <span class="fragment fade-in-then-out" data-fragment-index="5">
        <img src="./sources/covid/2020_li_science_fig1.png" width=50% style=";position:absolute; left:50%; top:20%; border:0; box-shadow:none; background:none;" align=center >
    </span>
    <span class="fragment fade-in-then-out" data-fragment-index="4">
        <img src="./sources/covid/2020_maier_science_fig1.png" width=50% style="position:absolute; left:50%; top:20%;border:0; box-shadow:none; background:none;" align=center >
    </span>
    <span class="fragment fade-in-then-out" data-fragment-index="6">
        <img src="./sources/covid/2020_dehning_science_figSummary.png" width=50% style="position:absolute; left:50%; top:20%; border:0; box-shadow:none; background:none;" align=center >
    </span>
    <span class="fragment fade-in-then-out" data-fragment-index="1">
        <img src="./sources/1927_kermack_fig1.png" width=30% style="position:absolute; left:60%; top:20%; border:0; box-shadow:none; background:none;" align=center >
        <small style="position:absolute; top:87%; left:60%; width:55%; text-align:left">(Plague in island of Bombay 12/1905 - 07/1906)</small>
    </span>
    <span class="fragment fade-in-then-out" data-fragment-index="2">
        <img src="./sources/covid/2013_brockmann_science_fig1.png" width=50% style="position:absolute; left:50%; top:20%; border:0; box-shadow:none; background:none;" align=center >
    </span>
    <span class="fragment fade-in-then-out" data-fragment-index="3">
        <img src="./sources/covid/2003_keeling_nature_fig1.png" width=35% style="position:absolute; left:55%; top:5%; border:0; box-shadow:none; background:none;" align=center >
    </span>

    <div style="position:absolute; bottom:1%; left:1.0%; width=98%; text-align:left">
        <small>
        <br>
        <span class="fragment fade-in" data-fragment-index="6">Dehning et al., Science (2020)</span><br>
        <span class="fragment fade-in" data-fragment-index="5">Li et al., Science (2020)</span><br>
        <span class="fragment fade-in" data-fragment-index="4">Maier & Brockmann, Science (2020)</span><br>
        <span class="fragment fade-in" data-fragment-index="3">Keeling et al., Nature (2003)</span><br>
        <span class="fragment fade-in" data-fragment-index="2">Brockmann & Helbig, Science (2013)</span><br>
        <span class="fragment fade-in" data-fragment-index="1">Kermack & McKendrick, Proc. R. Soc. Lond. A (1927)</span><br>
        </small>
    </div>
</section>


<section>
    <h3>How does a disease spread?</h3>
    <h4>Example COVID-19</h4>
    <img src="./sources/covid/2020_Cevik_disease_development.png" width=50%  style="border:0; box-shadow:none; position:absolute; top:25%; left:0%">
    <span class="fragment fade-in" data-fragment-index="2">
        <img src="./sources/COVID-19_spread_in_Germany_(27_February_to_22_March_2020).gif" width=35%  style="border:0; box-shadow:none; position:absolute; top:8%; left:60%">
    </span>
    <div style="position:absolute; bottom:1%; left:1.0%; width=98%; text-align:left">
      <small>
        <br>
        Source: Wikimedia Commons (Smurrayinchester)<br>
        Cevik et al., BMJ (2020).<br>
      </small>
    </div>
</section>


<section>
    <h3>What are necessary ingredients to model disease spread?</h3>
        <img src="./sources/weblogos/onlineTED.svg" width=40%  style="border:0; box-shadow:none; position:absolute; top:30%; left:30%">
</section>

<section>
    <h3>Modelling disease spread requires simplifications</h3>
    <h4>Simplify disease progression</h4>
    <span class="fragment fade-in" data-fragment-index="1">
        <img src="./sources/covid/2020_Cevik_disease_development.png" width=40%  style="border:0; box-shadow:none; position:absolute; top:13%; left:5%">
        <span  class="fragment fade-in-then-out" data-fragment-index="2">
            <img src="./sources/covid/2020_dehning_medrxiv_fig1.png" width=75%  style="clip-path:inset(2% 45% 0% 0%); border:0; box-shadow:none; position:absolute; top:55%; left:0%">
        </span>
        <span  class="fragment fade-in" data-fragment-index="4">
            <img src="./sources/2017_kiss_fig1.3.png" width=50%  style="border:0; box-shadow:none; position:absolute; top:60%; left:0%">
        </span>
    </span>

    <div style="position:absolute; top:17%; left: 52%; width:50%; text-align:left">
        <span  class="fragment fade-in" data-fragment-index="2">
            Simplify progression with distinct states:<br>
            <ul>
                <li> susceptible (S)</li>
                <li> exposed (E)</li>
                <li> infectious (I)</li>
                <li> recovered (R)</li>
                <li> hospitalized (H)</li>
                <li> dead (D)</li>
                <li> ...</li>
            </ul>
        </span>
        <br><br>
        <span  class="fragment fade-in" data-fragment-index="3">
            Simplify transitions between states:<br>
            <ul>
                <li> which states are connected?</li>
                <li> what is the state-duration distribution?</li>
                <li> variability between individuals?</li>
                <li> variability over time?</li>
            </ul>
        </span>
    </div>
    <div style="position:absolute; bottom:2%; left: 23%; width:80%; text-align:left">
        <span  class="fragment fade-in" data-fragment-index="5">
            Simplifications of disease progression are typically encoded in model name
        </span>
    </div>

    <div style="position:absolute; bottom:1%; left:1.0%; width=98%; text-align:left">
      <small>
        <br>
        Dehning et al., medrxiv (2020).<br>
        Cevik et al., BMJ (2020).<br>
      </small>
    </div>
</section>

<section>
    <h3>Modelling disease spread requires simplifications</h3>
    <h4>Simplify spreading process</h4>
    <span  class="fragment fade-in" data-fragment-index="2">
        <img src="./sources/2017_kiss_mathematics_of_epidemics_fig1.2.png" width=50%  style="border:0; box-shadow:none; position:absolute; top:15%; left:0%">
    </span>

    <div style="position:absolute; top:17%; left: 52%; width:50%; text-align:left">
        <span  class="fragment fade-in" data-fragment-index="2">
            Approximate spatial aspects (who interacts with whom):<br>
            <ul>
                <li> agent based (freely moving)</li>
                <li> agent based (network from real data)</li>
                <li> agent based (general networks)</li>
                <li> locally well-mixed (network of compartments)</li>
                <li> globally well-mixed (compartments)</li>
                <li> ... </li>
            </ul>
        </span>
        <br><br><br>
        <span  class="fragment fade-in" data-fragment-index="3">
            Simplify temporal aspects (interaction dynamics):<br>
            <ul>
                <li> explicitly model interactions for moving agents</li>
                <li> point-process model of interactions (inter-event distribution?)</li>
            </ul>
        </span>
    </div>
    <div style="position:absolute; bottom:2%; left: 10%; width:80%; text-align:center">
        <span  class="fragment fade-in" data-fragment-index="5">
            Simplifications on spreading dynamics are typically difficult to assess quickly
        </span>
    </div>
</section>


<section>
    <h3>Modelling disease spread requires simplifications</h3>
    <span  class="fragment fade-in" data-fragment-index="1">
    <div style="position:absolute; top:15%; left: 0%; width:50%; text-align:center">
        <h4>Disease progression</h4>
        disease states <br><br>
        <br>
        transition between states
        <br>
        <img src="./sources/2017_kiss_fig1.3.png" width=100%  style="border:0; box-shadow:none;">
    </div>
    </span>

    <span  class="fragment fade-in" data-fragment-index="2">
    <div style="position:absolute; top:15%; left: 50%; width:50%; text-align:center">
        <h4>Spreading process</h4>
        spatial aspects<br> (freely moving, network, well-mixed)<br>
        <br>
        temporal aspects (interaction dynamics)
        <br>
        <img src="./sources/2017_kiss_mathematics_of_epidemics_fig1.2.png" width=90%  style="border:0; box-shadow:none;" align=center>
    </div>
    </span>

    <div style="position:absolute; bottom:5%; left: 0%; width:50%; text-align:center">
        <span  class="fragment fade-in" data-fragment-index="5">
            Simplifications need to balance realism and simplicity tailored to specific question under investigation
        </span>
    </div>
</section>

<section>
    <h3>Modelling disease spread requires simplifications</h3>
    <h4>Example: Compartmental SIR</h4>

    <span class="fragment fade-out" data-fragment-index="10">
        <img src="./sources/covid/germany.png" width=85% style="position:absolute; top:11%; left:32%; width:36%; border:0; box-shadow:none; background:none;" align=center >
    <span class="fragment fade-in" data-fragment-index="1">
        <img id="person01" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:30%; left:55%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person02" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:32%; left:40%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person03" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:42%; left:50%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person04" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:52%; left:59%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person05" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:32%; left:42%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person06" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:42%; left:61%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person07" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:52%; left:40%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person08" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:72%; left:51%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person09" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:52%; left:55%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person10" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:62%; left:44%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person11" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:82%; left:45%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person12" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:82%; left:50%; width:2%; border:0; box-shadow:none; background:none;" align=center >
    </span>
    <span class="fragment fade-in" data-fragment-index="2">
        <img id="person04" src="./sources/covid/person_red.png" width=100% style="position:absolute; top:52%; left:59%; width:2%; border:0; box-shadow:none; background:none;" align=center >
    </span>
    <span class="fragment fade-in" data-fragment-index="3">
        <img id="person03" src="./sources/covid/person_red.png" width=100% style="position:absolute; top:42%; left:50%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person07" src="./sources/covid/person_red.png" width=100% style="position:absolute; top:52%; left:55%; width:2%; border:0; box-shadow:none; background:none;" align=center >
    </span>
    <span class="fragment fade-in" data-fragment-index="4">
        <img id="person04" src="./sources/covid/person_green.png" width=100% style="position:absolute; top:52%; left:59%; width:2%; border:0; box-shadow:none; background:none;" align=center >

        <img id="person01" src="./sources/covid/person_red.png" width=100% style="position:absolute; top:30%; left:55%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person12" src="./sources/covid/person_red.png" width=100% style="position:absolute; top:82%; left:50%; width:2%; border:0; box-shadow:none; background:none;" align=center >
    </span>
    </span>
    <span class="fragment fade-in" data-fragment-index="10">
        <img id="person05" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:20%; left:25%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person06" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:20%; left:27%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person02" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:20%; left:29%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person08" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:27%; left:25%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person09" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:27%; left:27%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person10" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:27%; left:29%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person11" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:34%; left:25%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person07" src="./sources/covid/person_red.png"   width=100% style="position:absolute; top:20%; left:50%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person12" src="./sources/covid/person_red.png"   width=100% style="position:absolute; top:20%; left:52%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person01" src="./sources/covid/person_red.png"   width=100% style="position:absolute; top:20%; left:54%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person03" src="./sources/covid/person_red.png"   width=100% style="position:absolute; top:27%; left:50%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person04" src="./sources/covid/person_green.png" width=100% style="position:absolute; top:20%; left:75%; width:2%; border:0; box-shadow:none; background:none;" align=center >
    </span>
    <span class="fragment fade-in" data-fragment-index="12">
        <div style="position:absolute; left:20%; top:17%; width:15%; height:4%; text-align:center; padding-top:13%; border:solid">
            <b>S</b>usceptible
        </div>
    </span>
    <span class="fragment fade-in" data-fragment-index="13">
        <div style="position:absolute; left:45%; top:17%; width:15%; height:4%; text-align:center; padding-top:13%; border:solid">
            <b>I</b>nfected
        </div>
    </span>
    <span class="fragment fade-in" data-fragment-index="14">
        <div style="position:absolute; left:70%; top:17%; width:15%; height:4%; text-align:center; padding-top:13%; border:solid">
            <b>R</b>ecovered
        </div>
    </span>
    <span class="fragment fade-in" data-fragment-index="15">
        <svg viewBox="0 0 350 100" style="position:absolute; top:5%; left:05%; width:90%;">
          <defs>
            <marker id="arrowhead" markerWidth="10" markerHeight="7"
            refX="0" refY="3.5" orient="auto">
              <polygon points="0 0, 10 3.5, 0 7" />
            </marker>
          </defs>
          <line x1="110" y1="50" x2="160" y2="50" stroke="#000"
          stroke-width="1" marker-end="url(#arrowhead)" />
          <line x1="207" y1="50" x2="258" y2="50" stroke="#000"
          stroke-width="1" marker-end="url(#arrowhead)" />
        </svg>
        <span class="fragment fade-in" data-fragment-index="20">
        <p  style="position:absolute; top:21%; left:35%; width:10%;"> $\lambda$ </p>
        <p  style="position:absolute; top:27%; left:35%; width:10%;"> spreading rate</p>
        </span>
        <span class="fragment fade-in" data-fragment-index="30">
        <p  style="position:absolute; top:21%; left:60%; width:10%;"> $\mu$ </p>
        <p  style="position:absolute; top:27%; left:60%; width:10%;"> recovery rate</p>
        </span>
    </span>

    <span class="fragment fade-out" data-fragment-index="50">
    <span class="fragment fade-in" data-fragment-index="30">
    <div style="position:absolute; top:80%; left: 50%; width:50%; text-align:center">
        <h4>Disease progression</h4>
        SIR where I decays with rate $\mu$
    </div>
    </span>
    <span class="fragment fade-in" data-fragment-index="20">
    <div style="position:absolute; top:80%; left: 00%; width:50%; text-align:center">
        <h4> Spreading process</h4>
        Well-mixed with uncorrelated contacts at rate $\lambda$ (Poisson process for each infected)
    </div>
    </span>
    </span>

    <span class="fragment fade-in" data-fragment-index="40">
        <div style="position:absolute; top:50%; left: 15%; width:35%; text-align:left">
            $\dot{S} = -\lambda\frac{S}{N} I$
            <br><br>
            $\dot{I} = +\lambda\frac{S}{N} I - \mu I$ <span  class="fragment fade-in" data-fragment-index="50"> $= \mu I\left(R_0\frac{S}{N}-1\right) $</span>
            <br><br>
            $\dot{R} = +\mu I$
        </div>
    </span>

    <span class="fragment fade-in-then-out" data-fragment-index="50">
        <img src="./sources/custom/deterministic_SIR_start_reproduction_number.png" style="border:0; box-shadow:none; position:absolute; top:50%; left:55%; width:40%;">
    </span>
    <span class="fragment fade-in-then-out" data-fragment-index="51">
        <img src="./sources/custom/deterministic_SIR_full_lambda1.5_mu1.0.png" style="border:0; box-shadow:none; position:absolute; top:50%; left:55%; width:40%;">
    </span>
    <span class="fragment fade-in-then-out" data-fragment-index="52">
        <img src="./sources/custom/deterministic_SIR_full_reproduction_number_S.png" style="border:0; box-shadow:none; position:absolute; top:50%; left:55%; width:40%;">
    </span>
     <div style="position:absolute; top:80%; left: 2%; width:50%; text-align:left">
         <span class="fragment fade-in-then-out" data-fragment-index="50">
             The ratio $\lambda/\mu=R_0$ (basic reproduction number) determines the growth during initial phase of outbreak.
             Here, $R_0=1$ is epidemic threshold.
         </span>
     </div>
     <div style="position:absolute; top:80%; left: 2%; width:50%; text-align:left">
         <span class="fragment fade-in-then-out" data-fragment-index="51">
             The peak in case numbers arises from infected interacting at rate
             $\lambda$ with random person (S, I, or R) of which only an S can
             be infected.
         </span>
     </div>
     <div style="position:absolute; top:80%; left: 2%; width:50%; text-align:left">
         <span class="fragment fade-in-then-out" data-fragment-index="52">
             The number of total infected depends on $R_0$, $S(0)$, and $R(0)$.<br>
         </span>
     </div>


    <div style="position:absolute; bottom:1%; left:1.0%; width=98%; text-align:left">
      <small>
        <br>
         Kermack and McKendrick, Proc. R. Soc. Lond. A (1927).<br>
      </small>
    </div>
</section>

<section>
    <h3>Modelling disease spread requires simplifications</h3>
    <h4>Example: Compartmental SIS</h4>

        <img id="person05" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:20%; left:25%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person06" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:20%; left:27%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person02" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:20%; left:29%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person08" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:27%; left:25%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person09" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:27%; left:27%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person10" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:27%; left:29%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person11" src="./sources/covid/person_black.png" width=100% style="position:absolute; top:34%; left:25%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person07" src="./sources/covid/person_red.png"   width=100% style="position:absolute; top:20%; left:50%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person12" src="./sources/covid/person_red.png"   width=100% style="position:absolute; top:20%; left:52%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person01" src="./sources/covid/person_red.png"   width=100% style="position:absolute; top:20%; left:54%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <img id="person03" src="./sources/covid/person_red.png"   width=100% style="position:absolute; top:27%; left:50%; width:2%; border:0; box-shadow:none; background:none;" align=center >
        <div style="position:absolute; left:20%; top:17%; width:15%; height:4%; text-align:center; padding-top:13%; border:solid">
            <b>S</b>usceptible
        </div>
        <div style="position:absolute; left:45%; top:17%; width:15%; height:4%; text-align:center; padding-top:13%; border:solid">
            <b>I</b>nfected
        </div>
    <span class="fragment fade-in" data-fragment-index="1">
        <svg viewBox="0 0 350 100" style="position:absolute; top:5%; left:05%; width:90%;">
          <defs>
            <marker id="arrowhead" markerWidth="10" markerHeight="7"
            refX="0" refY="3.5" orient="auto">
              <polygon points="0 0, 10 3.5, 0 7" />
            </marker>
          </defs>
          <line x1="120" y1="80" x2="145" y2="80" stroke="#000"
          stroke-width="1" marker-end="url(#arrowhead)" />
          <line x1="155" y1="30" x2="130" y2="30" stroke="#000"
          stroke-width="1" marker-end="url(#arrowhead)" />
        </svg>
        <span class="fragment fade-in" data-fragment-index="20">
        <p  style="position:absolute; top:40%; left:35%; width:10%;"> $\lambda$ </p>
        </span>
        <span class="fragment fade-in" data-fragment-index="30">
        <p  style="position:absolute; top:17%; left:35%; width:10%;"> $\mu$ </p>
        </span>
    </span>

    <span class="fragment fade-out" data-fragment-index="50">
    <span class="fragment fade-in" data-fragment-index="30">
    <div style="position:absolute; top:75%; left: 50%; width:50%; text-align:center">
        <h4>Disease progression</h4>
        Infected state decays with rate $\mu$
    </div>
    </span>
    <span class="fragment fade-in" data-fragment-index="20">
    <div style="position:absolute; top:75%; left: 00%; width:50%; text-align:center">
        <h4> Spreading process</h4>
        Well-mixed with uncorrelated contacts at rate $\lambda$ (Poisson process for each infected)
    </div>
    </span>
    </span>

    <span class="fragment fade-in" data-fragment-index="40">
        <div style="position:absolute; top:50%; left: 15%; width:35%; text-align:left">
            $\dot{S} = -\lambda\frac{S}{N} I + \mu I$
            <br><br>
            $\dot{I} = +\lambda\frac{S}{N} I - \mu I$
        </div>
    </span>


    <span class="fragment fade-in-then-out" data-fragment-index="50">
        <img src="./sources/custom/deterministic_SIS_full_lambda.png" style="border:0; box-shadow:none; position:absolute; top:50%; left:55%; width:40%;">
    </span>
     <div style="position:absolute; top:75%; left: 2%; width:50%; text-align:left">
         <span class="fragment fade-in-then-out" data-fragment-index="50">
             The ratio $\lambda/\mu$ determines equilibrium between actively infected and susceptible.<br>
         </span>
     </div>
</section>




<section>
    <h3>Modelling disease spread requires simplifications</h3>
    <h4>Examples of application</h4>

    <div style="position:absolute; top:20%; left: 5%; width:90%; text-align:left">
        <table style="width:100%">
            <tr  class="fragment fade-in" data-fragment-index="1">
                <th>Does initial infection cause outbreak?</th>
                <td>(stochastic) network models</td>
            </tr>
            <tr class="fragment fade-in" data-fragment-index="2">
                <th>How does X influence outbreak?</th>
                <td>SIR-X</td>
            </tr>
            <tr class="fragment fade-in" data-fragment-index="3">
                <th>How does X influence death numbers?</th>
                <td>SIRD-X with age-specific parameters</td>
            </tr>
        </table>
    </div>

    <span class="fragment fade-in-then-out" data-fragment-index="1">
        <img src="./sources/2004_hufnagel_fig1.jpg" width=25% style=";position:absolute; left:10%; top:50%; border:0; box-shadow:none; background:none;">
        <img src="./sources/2004_hufnagel_fig2.jpg" width=25% style=";position:absolute; left:60%; top:40%; border:0; box-shadow:none; background:none;">
    </span>
    <span class="fragment fade-in-then-out" data-fragment-index="2">
        <img src="./sources/covid/2020_maier_science_fig1.png" width=50% style="clip-path:inset(0% 0 50% 0); position:absolute; left:25%; top:50%;border:0; box-shadow:none; background:none;">
    </span>

    <div style="position:absolute; bottom:1%; left:1.0%; width=98%; text-align:left">
      <small>
        <br>
        <span class="fragment fade-in" data-fragment-index="2">Maier & Brockmann, Science (2020)</span><br>
        <span class="fragment fade-in" data-fragment-index="1">Hufnagel, Brockmann, Geisel, PNAS (2004)</span><br>
      </small>
    </div>
</section>



<section>
    <h3>Modelling disease spread requires simplifications</h3>
    <h4>Discussion</h4>


    <div style="position:absolute; top:15%; left: 5%; width:90%; text-align:left">
        <br><br>
        <span class="fragment fade-in" data-fragment-index="1">
        <ol>
            <li>
                Most naively, vaccination removes person from susceptible pool.
                How would this affect the spread? Can you qualitatively draw
                the number of actively infected over time in a partially
                vaccinated society?

            </li>
            <li>
            Imagine you are a research team with the aim to find the most effective
            vaccination protocol during an outbreak. What level of simplification
            is suitable? Start by specifying
            <ol>
            <li> What makes vaccination effective? Should it reduce deaths or should
                it reduce new infections? How does this affect your model?
            </li>
            <li> How localized is the disease? Is there only a few infected and
                can you know where? How does this affect your model?
            </li>
            <li> What do you know about disease transmission? Is it relevant
                that day-to-day human contacts often occur in clusters? How
                would this affect your model?
            </li>
            <li> Do you have data to parameterize the resulting model? If not,
                how meaningful is your study?
            </li>
            </ol>
            </li>
        </ol>
        </span>
    </div>
</section>

<section>
    <h3>Modelling disease spread requires simplifications</h3>
    <h4>Discussion</h4>


    <span class="fragment fade-out" data-fragment-index="0">
    <div style="position:absolute; top:20%; left: 5%; width:90%; text-align:left">
            1.
            Most naively, vaccination removes person from susceptible pool.
            How would this affect the spread? Can you qualitatively draw
            the number of actively infected over time in a partially
            vaccinated society?
    </div>
    <img src="./sources/custom/deterministic_SIR_full_lambda1.5_mu1.0_R.png" style="border:0; box-shadow:none; position:absolute; top:40%; left:40%; width:50%;">
    </span>
    <span class="fragment fade-in" data-fragment-index="1">
    <div style="position:absolute; top:20%; left: 5%; width:90%; text-align:left">
            2. Imagine you are a research team with the aim to find the most effective
            vaccination protocol during an outbreak. What level of simplification
            is suitable?
            <br>
            <div style="width:60%; text-align:left">
            <ul>
                <li class="fragment fade-in" data-fragment-index="1">
                    Level of simplification obviously depends on the precise
                    question and there is no general answer possible. Be critical
                    when reading papers.
                </li>
                <li class="fragment fade-in" data-fragment-index="2">
                    If interested in the general effect of vaccination: SIR +
                    vaccinated compartment can be enough.
                </li>
                <li class="fragment fade-in" data-fragment-index="3">
                    If interested in spatial aspects (local outbreaks): Interaction network (!parameterized!) inlcuding
                    point of origin and stochastic effects.
                </li>
                <li class="fragment fade-in" data-fragment-index="4">
                    If interested on individual basis (e.g. influential spreader):
                    Full (dynamic) contact network but now the level of
                    vaccination protection becomes relevant.
                </li>
            </ul>
            </div>
        </span>
    </div>


    <span class="fragment fade-in-then-out" data-fragment-index="0">
    </span>


    <span class="fragment fade-in" data-fragment-index="5">
    <div style=" border:3px;border-style:solid;position:absolute; top:45%; left:65%; width:33%; text-align:left;padding:0.2em">
        Level of detail should be consistent across model! If one incorporates
        too many details of specific component, then one easily misses
        relevant correlations.
        <br>
        $\to$ Simple models are powerful.
    </div>
    </span>

    <span class="fragment fade-in-then-out" data-fragment-index="3">
        <img src="./sources/2004_hufnagel_fig1.jpg" width=30% style=";position:absolute; left:65%; top:30%; border:0; box-shadow:none; background:none;">
    </span>
    <span class="fragment fade-in-then-out" data-fragment-index="2">
        <img src="./sources/covid/2020_maier_science_fig1.png" width=70% style="clip-path:inset(0% 50% 50% 0); position:absolute; left:65%; top:30%;border:0; box-shadow:none; background:none;">
    </span>

    <div style="position:absolute; bottom:1%; left:1.0%; width=98%; text-align:left">
      <small>
        <br>
        <span class="fragment fade-in" data-fragment-index="3">Hufnagel, Brockmann, Geisel, PNAS (2004)</span><br>
        <span class="fragment fade-in" data-fragment-index="2">Maier & Brockmann, Science (2020)</span><br>
      </small>
    </div>
</section>

<section>
    <h3>General introduction</h3>
    <div style="position:absolute; top:15%; left:15%; width:70%; height:15%; text-align:left; border:0px; box-shadow:none; background:none;" data-markdown>
        #### What have we learned?
        * Models simplify reality on different levels (disease progression, spreading dynamics)
        * Level of detail should be consistent (avoid making single compontent extremely realistic while keeping others utterly simple)
        * Simplifications have to be well motivated and re-evaluated when drawing conclusions
    </div>

    <span class="fragment fade-in" data-fragment-index="2">
        <h3 style="position:absolute; top:60%; left:0%; width:100%; text-align:center;">Questions?</h3>
    </span>

    <span class="fragment fade-in" data-fragment-index="3">
        <div style="position:absolute; top:75%; left:5%; width:90%; text-align:left;">
            Preparation for next lecture:<br>
            Please read section II of <br>
            R. Pastor-Satorras, C. Castellano, P. Van Mieghem, and A.
            Vespignani, <b>Epidemic Processes in Complex Networks</b>, Rev.
            Mod. Phys. 87, 925 (2015).
        </div>
    </span>
</section>


<!-- ############################################################################### -->
<section>
    <h3>Outline</h3>
    <div style="position:absolute; top:15%; left:15%; width:70%; height:15%; text-align:left; border:3px; border-style:solid; border-color:#708090; padding: 0.2em;">
        <h3 style="border:0; box-shadow:none; position:absolute; top:30%; left:0%; width:100%; text-align:center">General introduction</h3>
    </div>

    <div style="position:absolute; top:35%; left:15%; width:70%; height:15%;  text-align:left; border:3px; border-style:solid; border-color:#708090; padding: 0.2em;">
        <h3 style="border:0; box-shadow:none; position:absolute; top:30%; left:0%; width:100%; text-align:center">Mathematical basics</h3>
    </div>

    <div style="position:absolute; top:55%; left:15%; width:70%; height:15%;  text-align:left; border:3px; border-style:solid; border-color:#708090; padding: 0.2em;">
        <h3 style="border:0; box-shadow:none; position:absolute; top:30%; left:0%; width:100%; text-align:center">Disease spread on networks</h3>
    </div>

    <div style="position:absolute; top:75%; left:15%; width:70%; height:15%;  text-align:left; border:3px; border-style:solid; border-color:#708090; padding: 0.2em;">
        <h3 style="border:0; box-shadow:none; position:absolute; top:30%; left:0%; width:100%; text-align:center">Non-Markovian disease spread</h3>
    </div>
</section>

<!-- ############################################################################### -->
<!-- ######################  Mathematical Basics ################################## -->
<!-- ############################################################################### -->

<section>
    <h3>Mathematical basics</h3>
    <div style="position:absolute; top:15%; left:15%; width:70%; height:15%; text-align:left; border:0px; box-shadow:none; background:none;" data-markdown>
        #### What we will talk about
        * Stochastic representation of disease spread
        * How to derive deterministic representation from stochastic one
    </div>
    <div style="position:absolute; top:50%; left:15%; width:70%; text-align:left "class="fragment fade-in" data-fragment-index="2"  data-markdown>
        #### References
        * Kiss, Miller, and Simon, "Mathematics of Epidemics on Networks: From Exact to Approximate Models", (Springer International Publishing, Cham, 2017).
        * Pastor-Satorras, Castellano, Van Mieghem, and Vespignani, Rev. Mod. Phys. (2015).
        * Gillespie, Stochastic Simulation of Chemical Kinetics, Annual Review of Physical Chemistry 58, 35 (2007).
        * additional sources of examples are referened at bottom of slides
    </div>
</section>

<section>
    <h3>Stochastic formulation</h3>

    <span  class="fragment fade-in-then-out" data-fragment-index="1">
    <div style="position:absolute; top:15%; left: 0%; width:50%; text-align:center">
        <h4>Disease progression</h4>
        disease states <br><br>
        <br>
        transition between states
        <br>
        <img src="./sources/2017_kiss_fig1.3.png" width=100%  style="border:0; box-shadow:none;">
    </div>
    <div style="position:absolute; top:15%; left: 50%; width:50%; text-align:center">
        <h4>Spreading process</h4>
        spatial aspects<br> (freely moving, network, well-mixed)<br>
        <br>
        temporal aspects (interaction dynamics)
        <br>
        <img src="./sources/2017_kiss_mathematics_of_epidemics_fig1.2.png" width=90%  style="border:0; box-shadow:none;" align=center>
    </div>
    </span>

    <span  class="fragment fade-in" data-fragment-index="2">
    <div style="position:absolute; top:15%; left: 0%; width:50%; text-align:center">
        <h4>Disease progression</h4>
        <br><br>
        <br>
        transition between disease states
        <br>
        <span  class="fragment fade-in" data-fragment-index="3">
                (can be in principle assessed from clinical data, e.g.,
                distribution of infectious period ($I\to X$))

            </ul>
        </span>
    </div>
    <div style="position:absolute; top:17%; left:35%; width:30%; text-align:center">
        <img src="./sources/2017_kiss_fig1.3.png" width=100%  style="border:0; box-shadow:none;">
    </div>
    <div style="position:absolute; top:15%; left: 50%; width:50%; text-align:center">
        <h4>Spreading process</h4>
        <br> <br>
        <br>
        temporal aspects (interaction dynamics)
        <br>
        <span  class="fragment fade-in" data-fragment-index="4">
            ($S\to I$ more complicated)
            </ul>
        </span>
    </div>
    </span>

    <span  class="fragment fade-in" data-fragment-index="10">
    <div style="position:absolute; top:60%; left: 5%; width:90%; text-align:left">
        In the stochastic formulation, the system state becomes a random variable.
        <br><br>
        E.g., for the SIS model $S(t)$ and $I(t)=N-S(t)$ are random variables with states ${0,1.,...N}$.
        <br><br>
        The goal is usually to determine evolution equations for the
        probabilities of the observing a particular model configuration
        $x$, e.g. $x=(S,I)$, at a given time $t$.
    </div>
    </span>
</section>

<section>
    <h3>Stochastic formulation</h3>
    <h4>Example SIS</h4>
    <span  class="fragment fade-in" data-fragment-index="1">
    <div style="position:absolute; top:15%; left: 5%; width:65%; text-align:left">
        <b>Assumptions:</b>
        <br>
        <span  class="fragment fade-in" data-fragment-index="2">
            1) Infected individual recovers at rate $\mu$ independent of all others.
        </span>
        <br><br>
        <span  class="fragment fade-in" data-fragment-index="3">
            2) Infected individual contacts at rate $\lambda$ <b>any</b> other individual.
        </span>
        <br><br>
        <span  class="fragment fade-in" data-fragment-index="4">
            3) Both processes are Markovian, i.e., infection and recovery take place as events of a Poisson process.
        </span>
        <br><br>
    </div>
    <div style="position:absolute; top:15%; left: 70%; width:25%; text-align:center">
        <b></b>
        <br>
        <span  class="fragment fade-in" data-fragment-index="2">
            $I\to S$
        </span>
        <br><br>
        <span  class="fragment fade-in" data-fragment-index="3">
            $S+I\to I+I$
        </span>
        <br><br>
        <span  class="fragment fade-in" data-fragment-index="4">

        </span>
        <br><br>
    </div>
    </span>

    <span  class="fragment fade-in" data-fragment-index="10">
    <div style="position:absolute; top:55%; left: 5%; width:90%; text-align:left">
        We can treat this a continuous-time Markov chain with system state $x(t) = [S,I](t)$ and the following possible transitions:
        <div align=center>
            <br>
            $[S,I] \to [S+1,I-1]\,$ with rate $\,\mu I\phantom{\frac{S}{N}}$<br><br>
            $[S,I] \to [S-1,I+1]\,$ with rate  $\,\lambda I\frac{S}{N}$
        </div>
        <br>
        <span  class="fragment fade-in" data-fragment-index="11">
            <b>How can we model this?</b>
        </span>
    </div>
    </span>

</section>

<section>
    <h3>Kinetic Monte Carlo (Gillespie)</h3>
    <div style="position:absolute; top:10%; left:2.5%; width:95%; text-align:left">
        Setting: Evolution of system is determined by indep. Poisson processes (recovery, infection). <br>
        Goal: Generate one realization of this process. <br>
        <br>
        <span class="fragment fade-out" data-fragment-index="10">
        <span class="fragment fade-in" data-fragment-index="5">
            Poisson process is a counting process $N(t)$ s.t.<br>
            1) $N(0)=0$<br>
            2) independent increments<br>
            3) number of events in any time interval $\Delta T$ is Poisson distributed ($Pois(a_i\Delta T)$)
        </span>
        </span>
    </div>


    <span class="fragment fade-out" data-fragment-index="10">
    <span class="fragment fade-in" data-fragment-index="6">
        <img src="./sources/kineticMonteCarlo_gillespie_derivation.svg" width=50%  style="border:0; box-shadow:none; position:absolute; top:50%; left:35%">
        <p style="position:absolute; top:52%; left:12%">Poisson process 1:</p>
        <p style="position:absolute; top:60%; left:12%">Poisson process 2:</p>
        <p style="position:absolute; top:68%; left:12%">Poisson process 3:</p>
        <div style="position:absolute; top:20%; left:5%;text-align:left">
        </div>
    </span>
    </span>

    <!-- include illustration -->
    <span class="fragment fade-in" data-fragment-index="10">
        <img src="./sources/kineticMonteCarlo_gillespie.svg" width=50%  style="border:0; box-shadow:none; position:absolute; top:12%; left:45%">
    </span>

    <div style="position:absolute; top:25%; left:2.5%; width:52%; text-align:left">
        <span class="fragment fade-in" data-fragment-index="10">
            <b>Algorithm:</b>
        <br><br>
        <span class="fragment fade-in" data-fragment-index="11">
            1. Create initial condition x(t)=[x_1,...x_n] at $t=t_0$
        </span>
        <br><br>
        <span class="fragment fade-in" data-fragment-index="12">
            2. Calculate rates $a(t)=[a_1, ..., a_n]$
        </span>
        <br><br>
        <span class="fragment fade-in" data-fragment-index="13">
            3. Draw time $\Delta t$ until next event from exponential distribution with rate $\sum a_i$.
        </span>
        <br><br>
        <span class="fragment fade-in" data-fragment-index="14">
            4. Draw random event weighted with current rates
        </span>
        <br><br>
        <span class="fragment fade-in" data-fragment-index="15">
            5. Evolve time $t=t+\Delta t$ and realize event
        </span>
        <br><br>
        <span class="fragment fade-in" data-fragment-index="16">
            6. In case $t < T\phantom{>}$ go back to 2.
        </span>
    </div>
    <div style="position:absolute; top:25%; left:60.0%; width:40%; text-align:left">
        <span class="fragment fade-in" data-fragment-index="10">
            <br><br>
        <span class="fragment fade-in" data-fragment-index="11">
        $x(t_0)=[S_0, I_0]$
        </span>
        <br><br>
        <span class="fragment fade-in" data-fragment-index="12">
            $a(t)=\left[\mu I, \lambda \frac{S}{N}I\right]$
        </span>
        <br><br>
        <span class="fragment fade-in" data-fragment-index="13">
            $\Delta t = \frac{1}{a_1+a_2}\ln\left(\frac{1}{r_1}\right)$<br> with random number $r_1\in[0,1)$
        </span>
        <br>
        <span class="fragment fade-in" data-fragment-index="14">
             $j$ s.t $\frac{1}{\sum_i a_i}\sum_{i=1}^j a_i \lt r_2\in[0,1)$
        </span>
        <br><br>
        <span class="fragment fade-in" data-fragment-index="15">
            $j=1$: $I=I-1$, $S=S+1$<br>
            $j=2$: $I=I+1$, $S=S-1$<br>
        </span>
        <br><br>
    </div>


    <span class="fragment fade-in" data-fragment-index="20">
        <img src="./sources/custom/code_kineticMC_SIS.png" height=100%  style="border:0; box-shadow:none; position:absolute; top:2%; left:60%">
    </span>
</section>

<section>
    <h3>Stochastic formulation</h3>
    <h4>Example SIS</h4>
    <div style="position:absolute; top:17%; left: 5%; width:90%; text-align:left">
        Continuous-time Markov chain with system state $x(t) = [S,I](t)$ and the following possible transitions:
        <div align=center>
            $[S,I] \to [S+1,I-1]\,$ with rate $\,\mu I\phantom{\frac{S}{N}}$<br>
            $[S,I] \to [S-1,I+1]\,$ with rate  $\,\lambda I\frac{S}{N}$
        </div>
    </div>

    <span class="fragment fade-out" data-fragment-index="10">
    <span class="fragment fade-in" data-fragment-index="1">
        <img src="./sources/custom/deterministic_SIS_full_lambda.png" style="border:0; box-shadow:none; position:absolute; top:45%; left:5%; width:40%;">
    </span>
    <span class="fragment fade-in" data-fragment-index="2">
        <div style="position:absolute; top:50%; left:50%; width:50%; text-align:left">
            What do you believe will happen if we implement disease spread as a
            continuous-time Markov Chain?
            <br><br>
            What will happen for $R_0=\frac{\lambda}{\mu}\gt 1$?
            <br><br>
            What will be special  if we start from $I(0)=1$?
        </div>
    </span>
    </span>


    <span class="fragment fade-in" data-fragment-index="10">
        <img src="./sources/custom/kineticMC_example_SIS_I0_1.png" width=45%  style="border:0; box-shadow:none; position:absolute; top:40%; left:5%">
    </span>
    <span class="fragment fade-in" data-fragment-index="20">
        <img src="./sources/custom/kineticMC_example_SIS_I0_1_distributions.png" width=35%  style="border:0; box-shadow:none; position:absolute; top:37%; left:60%">
    </span>
</section>


<section>
    <h3>Stochastic formulation</h3>
    <h4>Difference to discrete formulation</h4>
    <div style="position:absolute; top:25%; left:15%; width:70%; text-align:left">
        <ol>
            <li class="fragment fade-in" data-fragment-index="1"> Quantities of interest are now described not by single values but by distributions</li>
            <li class="fragment fade-in" data-fragment-index="2"> System may actually end up in a disease-free state that it cannot escape (absorbing state)</li>
            <li class="fragment fade-in" data-fragment-index="3"> $R_0\gt 1$ may end up in disease-free state</li>
        </ol>
    </div>
</section>

<section>
    <h3>Stochastic formulation</h3>
    <h4>$R_0\gt 1$ may end up in disease-free state</h4>
    <img src="./sources/custom/kineticMC_example_SIS_I0_1_distributions.png" width=35%  style="border:0; box-shadow:none; position:absolute; top:15%; left:60%">

    <span class="fragment fade-out" data-fragment-index="10">
    <div style="position:absolute; top:20%; left:2%; width:60%; text-align:left">
        Assume that we start from a single infection [$I(0)=1$].
        <br>
        <span class="fragment fade-in" data-fragment-index="1">
            We can calculate the probability that this initial infection causes no further infection:
        <br><br>
        <span class="fragment fade-in" data-fragment-index="2">
            Infectious period is exponentially distributed (Poisson process):<br>
            $P(\Delta t) = \mu e^{-\mu\Delta t}$
        </span>
        <br><br>
        <span class="fragment fade-in" data-fragment-index="3">
            Infection is Poisson process at rate $\lambda$, s.t. probability to
            not observe any event in $\Delta t$ is <br>
            $p(\text{no event}) = e^{-\lambda \Delta t}$

        </span>
        <br><br>
        <span class="fragment fade-in" data-fragment-index="4">
        Probability no further infection:<br>
        $ p =\int_0^\infty d\Delta t\, e^{-\lambda \Delta t}\, \mu e^{-\mu\Delta t}$
        </span>
        <br>
        <span class="fragment fade-in" data-fragment-index="5">
            $\phantom{p} =\frac{\mu}{\mu+\lambda}\int_0^\infty d\Delta t\,(\mu+\lambda) e^{-(\mu+\lambda) \Delta t}$
        </span>
        <span class="fragment fade-in" data-fragment-index="6">
            $\phantom{p} =\frac{\mu}{\mu+\lambda}$
        </span>
    </div>
    <div style="position:absolute; top:85%; left:55%; width:40%; text-align:left"  class="fragment fade-in" data-fragment-index="7">
        Only lower bound because stochastic fluctuations can also end up in disease state from higher number of infections
    </div>
    </span>

    <span class="fragment fade-in" data-fragment-index="10">
    <div style="position:absolute; top:20%; left:2%; width:60%; text-align:left">
        More general, we can approximate a disease in its initial phase by a birth-death process ($S\approx N$):
        <img src="./sources/wikipedia_BD-proces.png" width=70%  style="border:0; box-shadow:none;">
        <br>
        With the population $I$, birth at rate $\lambda_I=\lambda I$ and death at rate $\mu_I=\mu I$
        <br><br>
        <span class="fragment fade-in" data-fragment-index="11">
            The theory of birth-death processes tells us that the "population" goes extinct with certain probabilities:
            <br><br>
            for $\lambda\lt\mu$ with $\lim_{t\to\infty}p(\text{no epidemic})=1$
            <br><br>
            for $\lambda\gt\mu$ with $\lim_{t\to\infty}p(\text{no epidemic})=\left(\frac{\mu}{\lambda}\right)^{I(0)}$
        </span>
    </div>

    <div style="position:absolute; top:80%; left:55%; width:40%; text-align:left"  class="fragment fade-in" data-fragment-index="12">
        We measure that $67\%$ of trajectories are in the disease-free state for $\lambda/\mu=1.5$, i.e., p=2/3 starting from $I(0)=1$
    </div>
    </span>
</section>

<section>
    <h3>Link between stochastic and deterministic formulation</h3>
    <h4>Example SIS</h4>
    <div style="position:absolute; top:17%; left: 5%; width:90%; text-align:left">
        <div align=center>
            $[S,I] \to [S+1,I-1]\,$ with rate $\,\mu I\phantom{\frac{S}{N}}$<span class="fragment fade-in" data-fragment-index="11">$=a_1(S,I)$ for $\nu_1=[+1,-1]$</span><br>
            $[S,I] \to [S-1,I+1]\,$ with rate  $\,\lambda I\frac{S}{N}$<span class="fragment fade-in" data-fragment-index="11">$=a_2(S,I)$ for $\nu_2=[-1,+1]$</span>
        </div>
    </div>

    <span class="fragment fade-out" data-fragment-index="10">
    <div style="position:absolute; top:32%; left: 5%; width:90%; text-align:left">
        <span class="fragment fade-in" data-fragment-index="1">
            By generating stochastic realizations of disease spread, we estimated the evolution of the probability distribution $P(x,t)$ to observe a particular state $x=[S,I]$
        </span>
        <br><br>
        <span class="fragment fade-in" data-fragment-index="2">
            This problem be formally expressed by a master equation
            $$
            \dot{P}(x,t) = \sum_{x^\prime} \left[\underbrace{a_{x^\prime \to x} P(x^\prime,t)}_{\text{gain}} - \underbrace{a_{x\to x^\prime} P(x,t)}_{\text{loss}}\right]
            $$
        </span>
        <span class="fragment fade-in" data-fragment-index="3">
            <ul>
                <li> gain and loss balance one another s.t. probability distribution remains normalized</li>
                <li> $a_{x^\prime \to x}$ are rates with unit $[\text{time}]^{-1}$</li>
                <li> also called Kolmogorov equation</li>
            </ul>
        </span>
    </div>
    </span>

    <span class="fragment fade-out" data-fragment-index="20">
    <span class="fragment fade-in" data-fragment-index="10">
    <div style="position:absolute; top:32%; left: 2.5%; width:95%; text-align:left">
        Master equation:
        <br>
        $$
        \begin{aligned}
            \dot{P}(S,I,t) &= \mu (I+1)P(S-1,I+1,t) + \lambda\frac{(S+1)(I-1)}{N}P(S+1,I-1,t)\\
            &\phantom{=}- \mu I\, P(S,I,t) - \lambda \frac{SI}{N}\,P(S,I,t)
        \end{aligned}
        $$
        <span class="fragment fade-in" data-fragment-index="11">
        Rewritten in terms of state-change vectors $\nu_1=[+1,-1]$ and $\nu_2=[-1,+1]$
        <br><br>
        $ \dot{P}\left(x,t\right)
        = a_1\left(x-\nu_1\right)P\left(x-\nu_1,t\right)
        + a_2\left(x-\nu_2\right)P\left(x-\nu_2,t\right)
        - a_1\left(x\right) P\left(x,t\right)
        - a_2\left(x\right) P\left(x,t\right)
        $
        $ \phantom{\dot{P}\left(x,t\right)}
        = \sum_j a_j\left(x-\nu_j\right)P\left(x-\nu_j,t\right) - a_j\left(x\right) P\left(x,t\right)
        $
        </span>
    </div>
    </span>
    </span>

    <span class="fragment fade-in" data-fragment-index="20">
    <div style="position:absolute; top:32%; left: 2.5%; width:95%; text-align:left">
        Master equation:
        $ \dot{P}\left(x,t\right)
        = \sum_j a_j\left(x-\nu_j\right)P\left(x-\nu_j,t\right) - a_j\left(x\right) P\left(x,t\right)
        $
        <br><br>
        <span class="fragment fade-in" data-fragment-index="21">
            The deterministic formulation should describe the development of the expectation value $\langle x\rangle (t) = \sum_x x P(x,t)$
        </span>
        <br><br>
        <span class="fragment fade-in" data-fragment-index="22">
            $\frac{d}{dt}\langle x\rangle = \sum_x x \dot{P}(x,t)
            = \sum_x \sum_j x a_j\left(x-\nu_j\right)P\left(x-\nu_j,t\right) - x a_j\left(x\right) P\left(x,t\right)$
        </span>
        <span class="fragment fade-in" data-fragment-index="23">
            $\phantom{\frac{d}{dt}\langle x\rangle = \sum_x x \dot{P}(x,t)}
              = \sum_j \sum_x (x+\nu_j) a_j\left(x\right)P\left(x,t\right) - x a_j\left(x\right) P\left(x,t\right)$
        </span>
        <span class="fragment fade-in" data-fragment-index="24">
            $\phantom{\frac{d}{dt}\langle x\rangle = \sum_x x \dot{P}(x,t)}
              = \sum_j \nu_j\langle a_j\left(x(t)\right)\rangle\approx \sum_j \nu_ja_j\left(\langle x(t)\rangle\right)$
        </span>
        <br><br>
        <span class="fragment fade-in" data-fragment-index="25">
            $\frac{d}{dt} S \approx \sum_j v_j^1 a_j(S,I) = +\mu I - \lambda\frac{S}{N}I$<br>
            $\frac{d}{dt} I \approx \sum_j v_j^2 a_j(S,I) = -\mu I + \lambda\frac{S}{N}I$
        </span>
    </div>
        <span class="fragment fade-in" data-fragment-index="26">
        <div style="position:absolute; top:80%; left: 55%; width:30%; text-align:center; border:3px; border-style:solid;">
            $\dot{S} = -\lambda\frac{S}{N} I + \mu I$
            <br><br>
            $\dot{I} = +\lambda\frac{S}{N} I - \mu I$
        </div>
        </span>
    </span>


    <span class="fragment fade-in" data-fragment-index="30">
    <img src="./sources/custom/kineticMC_example_SIS_I0_1.png" width=35%  style="border:0; position:absolute; top:50%; left:64%">
    </span>


    <div style="position:absolute; bottom:1%; left:1.0%; width=98%; text-align:left">
      <small>
        <br>
        <span>Gillespie, Annu. Rev. Phys. Chem. (2007)</span><br>
      </small>
    </div>
</section>



<section>
    <h3>Stochastic formulation</h3>
    <h4>Example SIR (shift of peak)</h4>
    <div style="position:absolute; top:17%; left: 5%; width:90%; text-align:left">
        Continuous-time Markov chain with system state $x(t) = [S,I,R](t)$ and the following possible transitions:
        <div align=center>
            $[S,I,R] \to [S  ,I-1,R+1]\,$ with rate $\,\mu I\phantom{\frac{S}{N}}$<br>
            $[S,I,R] \to [S-1,I+1,R]\,$ with rate  $\,\lambda I\frac{S}{N}$
        </div>
    </div>

    <span class="fragment fade-in-then-out" data-fragment-index="5">
        <img src="./sources/custom/code_kineticMC_SIS.png" height=100%  style="border:0; box-shadow:none; position:absolute; top:2%; left:60%">
        <img src="./sources/custom/code_kineticMC_SIR.png" height=100%  style="border:0; box-shadow:none; position:absolute; top:2%; left:10%">
    </span>

    <span class="fragment fade-out" data-fragment-index="30">
    <span class="fragment fade-in" data-fragment-index="10">
        <img src="./sources/custom/kineticMC_example_SIR_I0_1.png" width=45%  style="border:0; box-shadow:none; position:absolute; top:40%; left:5%">
    </span>
    <span class="fragment fade-in-then-out" data-fragment-index="20">
        <img src="./sources/custom/kineticMC_example_SIR_I0_1_distribution_I.png" width=35%  style="border:0; box-shadow:none; position:absolute; top:37%; left:60%">
    </span>
    <span class="fragment fade-in" data-fragment-index="21">
        <img src="./sources/custom/kineticMC_example_SIR_I0_1_distribution_R.png" width=48%  style="border:0; box-shadow:none; position:absolute; top:37%; left:50%">
    </span>
    </span>
    <span class="fragment fade-in" data-fragment-index="30">
        <img src="./sources/custom/kineticMC_example_SIR_R2_I0_10_long.png" width=45%  style="border:0; box-shadow:none; position:absolute; top:40%; left:5%">
        <div style="position:absolute; top:50%; left: 50%; width:50%; text-align:left">
            If $I$ gets large enough, stochastic fluctuations cancel each other out the disease spread
            for a single realization can be described by the deterministic solution.<br>
            The point where this happens, however, depends on the random
            realization such that the location of the peak of the curve
            fluctuates.
        </div>
    </span>
</section>


<section>
    <h3>Mathematical basics</h3>
    <div style="position:absolute; top:15%; left:15%; width:70%; height:15%; text-align:left; border:0px; box-shadow:none; background:none;" data-markdown>
        #### What have we learned?
        * Stochastic formulation (master equation) typically assumes Poisson processes and can be described by a continuous-time Markov Chain.
        * Stochastic formulation includes the possibility for the system to reach a disease-free state.
        * Deterministic formulation (differential equations) describes the evolution of the expectation value of states.
    </div>

    <span class="fragment fade-in" data-fragment-index="2">
        <h3 style="position:absolute; top:60%; left:0%; width:100%; text-align:center;">Questions?</h3>
    </span>

    <span class="fragment fade-in" data-fragment-index="3">
        <div style="position:absolute; top:75%; left:5%; width:90%; text-align:left;">
            Preparation for next lecture:<br>
            Please read section III of <br>
            R. Pastor-Satorras, C. Castellano, P. Van Mieghem, and A.
            Vespignani, <b>Epidemic Processes in Complex Networks</b>, Rev.
            Mod. Phys. 87, 925 (2015).
        </div>
    </span>
</section>



<!-- ############################################################################### -->
<section>
    <h3>Outline</h3>
    <div style="position:absolute; top:15%; left:15%; width:70%; height:15%; text-align:left; border:3px; border-style:solid; border-color:#708090; padding: 0.2em;">
        <h3 style="border:0; box-shadow:none; position:absolute; top:30%; left:0%; width:100%; text-align:center">General introduction</h3>
    </div>

    <div style="position:absolute; top:35%; left:15%; width:70%; height:15%;  text-align:left; border:3px; border-style:solid; border-color:#708090; padding: 0.2em;">
        <h3 style="border:0; box-shadow:none; position:absolute; top:30%; left:0%; width:100%; text-align:center">Mathematical basics</h3>
    </div>

    <div style="position:absolute; top:55%; left:15%; width:70%; height:15%;  text-align:left; border:3px; border-style:solid; border-color:#708090; padding: 0.2em;">
        <h3 style="border:0; box-shadow:none; position:absolute; top:30%; left:0%; width:100%; text-align:center">Disease spread on networks</h3>
    </div>

    <div style="position:absolute; top:75%; left:15%; width:70%; height:15%;  text-align:left; border:3px; border-style:solid; border-color:#708090; padding: 0.2em;">
        <h3 style="border:0; box-shadow:none; position:absolute; top:30%; left:0%; width:100%; text-align:center">Non-Markovian disease spread</h3>
    </div>
</section>



<!-- ############################################################################### -->
<!-- ##################  Disease spread on complex networks  ####################### -->
<!-- ############################################################################### -->




</div>
</div>

<script src="dist/reveal.js"></script>
<script src="plugin/notes/notes.js"></script>
<script src="plugin/markdown/markdown.js"></script>
<script src="plugin/highlight/highlight.js"></script>
<script src="plugin/math/math.js"></script>
<script>
    // More info about config & dependencies:
    // - https://github.com/hakimel/reveal.js#configuration
    // - https://github.com/hakimel/reveal.js#dependencies
    Reveal.initialize({
	    margin: 0.02,
	    width:  1920,
        height: 1080,
	    center: false,
	    viewDistance: 3,
	    fragmentInURL: true,
	    slideNumber:true,
	    history:true,
        transition:"none",
        //transition:"convex",
        //transitionSpeed:"normal",
        transitionSpeed:"fast",

        math: {
    	    mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
    	    //mathjax: '/home/johannes/local_build/MathJax/MathJax.js',
    	    config: 'TeX-AMS_HTML-full'  // See http://docs.mathjax.org/en/latest/config-files.html
        },
		plugins: [ RevealMath, RevealMarkdown ],
		dependencies: [
		  // Cross-browser shim that fully implements classList - https://github.com/eligrey/classList.js/
            { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
            // Interpret Markdown in <section> elements
            { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
            { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
            // Syntax highlight for <code> elements
            { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
            // Zoom in and out with Alt+click
            { src: 'plugin/zoom-js/zoom.js', async: true },
            // Speaker notes
            { src: 'plugin/notes/notes.js', async: true },
            // MathJax
            //{ src: 'plugin/math/math.js', async: true }
		]
	});
</script>
</body>
</html>
